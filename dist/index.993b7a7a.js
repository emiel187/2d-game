var t=globalThis,e={},i={},s=t.parcelRequiref92b;null==s&&((s=function(t){if(t in e)return e[t].exports;if(t in i){var s=i[t];delete i[t];var o={id:t,exports:{}};return e[t]=o,s.call(o.exports,o,o.exports),o.exports}var a=Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(t,e){i[t]=e},t.parcelRequiref92b=s);var o=s.register;o("27Lyk",function(t,e){Object.defineProperty(t.exports,"register",{get:()=>i,set:t=>i=t,enumerable:!0,configurable:!0});var i,s=new Map;i=function(t,e){for(var i=0;i<e.length-1;i+=2)s.set(e[i],{baseUrl:t,path:e[i+1]})}}),o("12jfn",function(t,e){t.exports=new URL("Player.00f3c4d9.png",import.meta.url).toString()}),o("6dKHh",function(t,e){t.exports=new URL("Player_Actions.bca40ab9.png",import.meta.url).toString()}),o("5dwZ7",function(t,e){t.exports=new URL("orc1_attack_full.fdb40cd8.png",import.meta.url).toString()}),o("2mQDJ",function(t,e){t.exports=new URL("orc1_death_full.bc9dd58e.png",import.meta.url).toString()}),o("5BzKt",function(t,e){t.exports=new URL("orc1_hurt_full.64131593.png",import.meta.url).toString()}),o("gl7lL",function(t,e){t.exports=new URL("orc1_idle_full.f3f4fbc3.png",import.meta.url).toString()}),o("1SJUz",function(t,e){t.exports=new URL("orc1_run_full.e8aa27ea.png",import.meta.url).toString()}),o("jtYkY",function(t,e){t.exports=new URL("orc1_run_attack_front_full.e30546ea.png",import.meta.url).toString()}),o("5wsiR",function(t,e){t.exports=new URL("orc1_walk_full.d1a5a195.png",import.meta.url).toString()}),o("kHKgT",function(t,e){t.exports=new URL("orc1_walk_attack_front_full.63d42a92.png",import.meta.url).toString()}),o("1ofSC",function(t,e){t.exports=new URL("orc2_attack_full.6c54090d.png",import.meta.url).toString()}),o("l82DG",function(t,e){t.exports=new URL("orc2_death_full.277da092.png",import.meta.url).toString()}),o("aqAs5",function(t,e){t.exports=new URL("orc2_hurt_full.48867d66.png",import.meta.url).toString()}),o("geGul",function(t,e){t.exports=new URL("orc2_idle_full.d60b055c.png",import.meta.url).toString()}),o("kpWxC",function(t,e){t.exports=new URL("orc2_run_full.22586806.png",import.meta.url).toString()}),o("6L4gS",function(t,e){t.exports=new URL("orc2_run_attack_full.f470036c.png",import.meta.url).toString()}),o("l2YvV",function(t,e){t.exports=new URL("orc2_walk_full.af776d65.png",import.meta.url).toString()}),o("lqbBE",function(t,e){t.exports=new URL("orc2_walk_attack_full.b7833add.png",import.meta.url).toString()}),o("8e4iu",function(t,e){t.exports=new URL("orc3_attack_full.0a748c24.png",import.meta.url).toString()}),o("f1cee",function(t,e){t.exports=new URL("orc3_death_full.01806b71.png",import.meta.url).toString()}),o("1WwBw",function(t,e){t.exports=new URL("orc3_hurt_full.5859101d.png",import.meta.url).toString()}),o("8FuLj",function(t,e){t.exports=new URL("orc3_idle_full.416d922d.png",import.meta.url).toString()}),o("c4xtF",function(t,e){t.exports=new URL("orc3_run_full.5b379633.png",import.meta.url).toString()}),o("gQ05Q",function(t,e){t.exports=new URL("orc3_run_attack_full.bad10f7d.png",import.meta.url).toString()}),o("9mpTG",function(t,e){t.exports=new URL("orc3_walk_full.999de51c.png",import.meta.url).toString()}),o("a62Tn",function(t,e){t.exports=new URL("orc3_walk_attack_full.c6f0a883.png",import.meta.url).toString()}),o("hcwiQ",function(t,e){t.exports=new URL("Rock6_1.73bf617e.png",import.meta.url).toString()}),o("gfIFS",function(t,e){t.exports=new URL("Sand_ruins3.73cad079.png",import.meta.url).toString()}),o("dcz8z",function(t,e){t.exports=new URL("Snow_ruins3.dff3d94b.png",import.meta.url).toString()}),o("8WxSr",function(t,e){t.exports=new URL("Yellow_ruins3.8dea241e.png",import.meta.url).toString()}),o("gOdju",function(t,e){t.exports=new URL("Green_crystal2.bc1273ec.png",import.meta.url).toString()}),o("l0OAv",function(t,e){t.exports=new URL("Red_crystal2.a52bdbb5.png",import.meta.url).toString()}),o("6Z5FU",function(t,e){t.exports=new URL("Blue_crystal2.5546ca30.png",import.meta.url).toString()}),o("23iPg",function(t,e){t.exports=new URL("Yellow_crystal2.9e18555c.png",import.meta.url).toString()}),s("27Lyk").register(new URL("",import.meta.url).toString(),JSON.parse('["3xbAi","index.993b7a7a.js","itZfU","Player.00f3c4d9.png","ita0D","Player_Actions.bca40ab9.png","kaz4F","orc1_attack_full.fdb40cd8.png","aA0na","orc1_death_full.bc9dd58e.png","14oS4","orc1_hurt_full.64131593.png","aBOtM","orc1_idle_full.f3f4fbc3.png","fom00","orc1_run_full.e8aa27ea.png","jmNAU","orc1_run_attack_front_full.e30546ea.png","32waU","orc1_walk_full.d1a5a195.png","dG0jj","orc1_walk_attack_front_full.63d42a92.png","hiHze","orc2_attack_full.6c54090d.png","fgvI7","orc2_death_full.277da092.png","bU4g7","orc2_hurt_full.48867d66.png","lIfx8","orc2_idle_full.d60b055c.png","cZ4gW","orc2_run_full.22586806.png","eoVup","orc2_run_attack_full.f470036c.png","kua4s","orc2_walk_full.af776d65.png","acXCG","orc2_walk_attack_full.b7833add.png","63M4D","orc3_attack_full.0a748c24.png","llK0O","orc3_death_full.01806b71.png","4aDmc","orc3_hurt_full.5859101d.png","1SuzR","orc3_idle_full.416d922d.png","5iGxJ","orc3_run_full.5b379633.png","dEoH5","orc3_run_attack_full.bad10f7d.png","c82Rz","orc3_walk_full.999de51c.png","g0TG9","orc3_walk_attack_full.c6f0a883.png","6I6cX","Rock6_1.73bf617e.png","rncMt","Sand_ruins3.73cad079.png","5Ossz","Snow_ruins3.dff3d94b.png","d8MMO","Yellow_ruins3.8dea241e.png","h5Jde","Green_crystal2.bc1273ec.png","2LNSA","Red_crystal2.a52bdbb5.png","9XSoq","Blue_crystal2.5546ca30.png","7TG8P","Yellow_crystal2.9e18555c.png"]'));const a={width:1280,height:640,cellWidth:64,cellHeight:64},n={up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",attack:"a",space:" ",esc:"Escape",pick:"p",axe:"x",potion:"u"};var r=class{_position;_width;_height;_sprites;_type;constructor(t,e,i,s,o=a.cellWidth,n=a.cellHeight){this._position={x:t,y:e},this._width=o,this._height=n,this._type=i,this._sprites=this.selectSprites(s)}getPosition(){return{...this._position}}getType(){return this._type}getHitBox(){return{x:this._position.x,y:this._position.y,width:this._width,height:this._height}}selectSprites(t){return{}}update(){}draw(t){}},l=class extends r{#t;#e;#i;constructor(t,e,i){super(t,e,"player",i),this.#t=100,this.#e=5,this.explosives=[],this.keys=[],this.powerups=[],this.#i={left:!1,right:!1,up:!1,down:!1},this.currentFrame=0,this.frameCount=0,this.movement="down",this.action="idle"}selectSprites(t){return{movement:t.playerMovement,actions:t.playerActions}}getPickupRange(){return{x:this._position.x,y:this._position.y,width:this._width,height:this._height}}getHitBox(){return{x:this._position.x+.25*this._width,y:this._position.y+.25*this._height,width:.5*this._width,height:.5*this._height}}collide(t){if("idle"!==this.action){console.log("Colliding",this.action,t.getPosition()),this.action="idle";let e=t.getPosition(),i=this.getPosition();e.x<i.x?this.#i.left=!0:e.x>i.x&&(this.#i.right=!0),e.y<i.y?this.#i.up=!0:e.y>i.y&&(this.#i.down=!0),console.log("blocked directions",this.#i)}}canMove(t){return!this.#i[t]}moveLeft(){this.canMove("left")&&(this._position.x-=this.#e,this.action="walk",this.movement="left",this.#i.right=!1)}moveRight(){this.canMove("right")&&(this._position.x+=this.#e,this.action="walk",this.movement="right",this.#i.left=!1)}moveUp(){this.canMove("up")&&(this._position.y-=this.#e,this.action="walk",this.movement="up",this.#i.down=!1)}moveDown(){this.canMove("down")&&(this._position.y+=this.#e,this.action="walk",this.movement="down",this.#i.up=!1)}attack(){this.action="attack",console.log("Attacking")}pick(){this.action="pick",console.log("Picking");let t={x:this._position.x,y:this._position.y};switch(this.movement){case"left":t.x-=32;break;case"right":t.x+=32;break;case"up":t.y-=32;break;case"down":t.y+=32}console.log(`Attempting to pick at position: (${t.x}, ${t.y})`)}axe(){this.action="axe",console.log("Axe")}potion(){this.action="potion",console.log("Potion")}collectExplosive(t){this.explosives.push(t)}collectKey(t){this.keys.push(t)}collectPowerup(t){this.powerups.push(t),console.log(`Collected powerup: ${t}`)}update(){if(this.frameCount++,this.frameCount>=10){let t=6;"walk"===this.action||"idle"===this.action||"jump"===this.action?t=6:"attack"===this.action||"duck"===this.action?t=4:("pick"===this.action||"axe"===this.action||"potion"===this.action)&&(t=4),this.currentFrame=(this.currentFrame+1)%t,this.frameCount=0}}checkCollision(t){let e={...this._position};switch(t){case"left":e.x-=this.#e;break;case"right":e.x+=this.#e;break;case"up":e.y-=this.#e;break;case"down":e.y+=this.#e}return e}draw(t){let e=32,i=32,s=0,o=0,n=this._sprites.movement;switch(this.action){case"walk":switch(this.movement){case"left":case"right":o=4*e;break;case"up":o=2*e;break;case"down":o=0*e}break;case"crawl":switch(this.movement){case"down":case"up":o=0*e;break;case"left":case"right":o=9*e}break;case"attack":switch(this.movement){case"down":o=6*e;break;case"left":case"right":o=7*e;break;case"up":o=8*e}break;case"pick":switch(e=48,i=48,n=this._sprites.actions,this.movement){case"down":o=1*e;break;case"left":case"right":o=0*e;break;case"up":o=2*e}break;case"axe":e=48,i=48,n=this._sprites.actions,s=3*i,o=10*e;break;case"potion":switch(e=48,i=48,n=this._sprites.actions,this.movement){case"down":case"left":case"right":o=9*e;break;case"up":o=10*e}break;default:switch(this.movement){case"down":o=0*e;break;case"left":case"right":o=1*e;break;case"up":o=2*e}}console.log("drawing player",this.action,s,o),s=this.currentFrame*i,t.save(),"left"===this.movement?(t.scale(-1,1),t.drawImage(n,s,o,i,e,-this._position.x-this._width,this._position.y,a.cellWidth,a.cellHeight)):t.drawImage(n,s,o,i,e,this._position.x,this._position.y,a.cellWidth,a.cellHeight),t.restore(),this.drawBoundingBox(t)}drawBoundingBox(t){t.save(),t.strokeStyle="red",t.lineWidth=2,t.strokeRect(this._position.x+.25*this._width,this._position.y+.25*this._height,.5*this._width,.5*this._height),t.restore(),t.save(),t.strokeStyle="green",t.lineWidth=2,t.strokeRect(this._position.x,this._position.y,this._width,this._height),t.restore()}};class c{constructor(t,e,i,s){this.number=t,this.difficulty=e,this.layout=i,this.theme=s}}const h=new class{constructor(){this.levels=[]}addLevel(t){this.levels.push(t)}getLevel(t){return this.levels[t-1]||null}};function d(t){t.innerHTML=""}function p(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}h.addLevel(new c(1,"easy",[[" "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "],[" "," "," "," "," "," ","#","#","#","#","#","#","#","#"," "," "," "," "," "," "],[" "," "," "," "," "," ","#","P"," "," "," "," "," ","#"," "," "," "," "," "," "],[" "," "," "," "," "," ","#"," ","#","#","#"," "," ","#"," "," "," "," "," "," "],[" "," "," "," "," "," ","#"," ","#","X","#"," ","C","#"," "," "," "," "," "," "],[" "," "," "," "," "," ","#"," ","#"," "," "," "," ","#"," "," "," "," "," "," "],[" "," "," "," "," "," ","#","#","#"," ","#"," ","G","#"," "," "," "," "," "," "],[" "," "," "," "," "," ","#"," ","C","G"," ","E"," ","#"," "," "," "," "," "," "],[" "," "," "," "," "," ","#","#","#","#","#","#","#","#"," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "]])),h.addLevel(new c(2,"easy",[[" "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "],[" "," "," "," "," "," ","#","#","#","#","#","#","#","#"," "," "," "," "," "," "],[" "," "," "," "," "," ","#","P"," "," "," "," "," ","#"," "," "," "," "," "," "],[" "," "," "," "," "," ","#"," ","#","#","#"," "," ","#"," "," "," "," "," "," "],[" "," "," "," "," "," ","#"," ","#"," ","#"," ","C","#"," "," "," "," "," "," "],[" "," "," "," "," "," ","#","E"," "," "," "," "," ","#"," "," "," "," "," "," "],[" "," "," "," "," "," ","#","#","#"," ","#"," ","G","#"," "," "," "," "," "," "],[" "," "," "," "," "," ","#"," ","C","G"," ","E"," ","X"," "," "," "," "," "," "],[" "," "," "," "," "," ","#","#","#","#","#","#","#","#"," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "]])),h.addLevel(new c(3,"medium",[["#","#","#","#","#","#","#","#","#","#"],["#","P"," "," "," "," "," "," "," ","#"],["#"," ","#"," ","#"," ","#"," "," ","#"],["#"," ","#"," ","#"," ","#"," "," ","#"],["#"," "," "," "," "," "," "," "," ","#"],["#"," ","#"," ","#"," ","#"," "," ","#"],["#"," ","#"," ","#"," ","#"," "," ","#"],["#"," "," "," "," "," "," "," "," ","#"],["#","#","#","#","#","#","#","#","#","#"]])),h.addLevel(new c(4,"hard",[["#","#","#","#","#","#","#","#","#","#","#","#"],["#","P"," "," "," "," "," "," "," "," "," ","#"],["#"," ","#"," ","#"," ","#"," ","#"," "," ","#"],["#"," ","#"," ","#"," ","#"," ","#"," "," ","#"],["#"," "," "," "," "," "," "," "," "," "," ","#"],["#"," ","#"," ","#"," ","#"," ","#"," "," ","#"],["#"," ","#"," ","#"," ","#"," ","#"," "," ","#"],["#"," "," "," "," "," "," "," "," "," "," ","#"],["#","#","#","#","#","#","#","#","#","#","#","#"]])),h.addLevel(new c(5,"expert",[["#","#","#","#","#","#","#","#","#","#","#","#","#","#"],["#","P"," "," "," "," "," "," "," "," "," "," "," ","#"],["#"," ","#"," ","#"," ","#"," ","#"," ","#"," "," ","#"],["#"," ","#"," ","#"," ","#"," ","#"," ","#"," "," ","#"],["#","O"," ","O"," ","O"," "," "," "," "," "," "," ","#"],["#"," ","#"," ","#"," ","#"," ","#"," ","#"," "," ","#"],["#"," ","#"," ","#"," ","#"," ","#"," ","#"," "," ","#"],["#"," "," "," "," "," "," "," "," "," "," "," "," ","#"],["#"," ","#"," ","#"," ","#"," ","#"," ","#"," "," ","#"],["#"," ","#"," ","#"," ","#"," ","#"," ","#"," "," ","#"],["#"," "," "," "," "," "," "," "," "," "," "," "," ","#"],["#","#","#","#","#","#","#","#","#","#","#","#","#","#"]]));var u=class extends r{#s;constructor(t,e,i,s){super(t,e),this.#s=i,this._sprite=s.rock}getType(){return this.#s}collide(t){console.log(`Collision with ${t.constructor.name}`)}update(){}draw(t){let e=0;switch(this.#s){case"breakable":e=a.cellHeight;break;case"secret":e=2*a.cellHeight;break;default:e=0}t.drawImage(this._sprite,0,e,this._width,this._height,this._position.x,this._position.y,this._width,this._height)}},g=class extends r{#o;#a;constructor(t,e,i){super(t,e),this.#o=!0,this.#a=!1,this._sprite=i.explosiveSprite}isHidden(){return this.#o}isActive(){return this.#a}reveal(){this.#o=!1}detonate(){this.#a=!0,console.log("Explosive detonated!")}checkCollision(t){}update(){}draw(t){this.#o||t.drawImage(this._sprite,this._position.x,this._position.y,this._width,this._height)}},m=class extends r{#e;#n;#r;constructor(t,e,i,s){super(t,e,i,s,91,91),this.action="idle",this.movement=["down","up","left","right"][Math.floor(4*Math.random())],this.#e=1,this.#n=5*a.cellWidth,this.#r=this._sprites.idle,this.frameCount=0,this.currentFrame=0}selectSprites(t){return{attack:t[`${this._type}_Attack`],death:t[`${this._type}_Death`],hurt:t[`${this._type}_Hurt`],idle:t[`${this._type}_Idle`],run:t[`${this._type}_Run`],runAttack:t[`${this._type}_Run_Attack`],walk:t[`${this._type}_Walk`],walkAttack:t[`${this._type}_Walk_Attack`]}}moveTowards(t,e){let i=t.x-this._position.x,s=t.y-this._position.y;Math.abs(i)>Math.abs(s)?this.movement=i>0?"right":"left":this.movement=s>0?"down":"up";let o={...this._position,width:a.cellWidth/2,height:a.cellHeight/2};switch(this.movement){case"up":o.y-=this.#e;break;case"down":o.y+=this.#e;break;case"left":o.x-=this.#e;break;case"right":o.x+=this.#e}let n=e.some(t=>p(o,t.getHitBox()));p(o,t)?(console.log("Attacking player"),Math.abs(i)>Math.abs(s)?this.movement=i>0?"right":"left":this.movement=s>0?"down":"up",this.attack()):n?(console.log("Idle"),this.idle()):(console.log("Moving towards player"),this._position=o,this.walk())}detectPlayer(t,e){let i=t.x-this._position.x,s=t.y-this._position.y,o=Math.sqrt(i*i+s*s);if(o<=this.#n){let t={x:i/o,y:s/o},n={...this._position,width:a.cellWidth/2,height:a.cellHeight/2};for(let i=0;i<o;i+=a.cellWidth/2)if(n.x+=t.x*(a.cellWidth/2),n.y+=t.y*(a.cellWidth/2),e.some(t=>p(n,t.getHitBox())))return!1;return!0}return!1}idle(){this.action="idle",this.#r=this._sprites.idle}walk(){this.action="walk",this.#r=this._sprites.walk}attack(){this.action="attack",this.#r=this._sprites.attack}defeat(){this.action="dead",this.#r=this._sprites.death}lookAround(){this.action="idle",this.#r=this._sprites.idle;let t=["up","right","down","left"],e=t.indexOf(this.movement);-1!==e?this.movement=t[(e+1)%4]:this.movement="up"}update(t,e){let i="idle"===this.action?180:20;this.frameCount++,this.frameCount>=i&&(this.frameCount=0,this.currentFrame=(this.currentFrame+1)%4),this.detectPlayer(t,e)?this.moveTowards(t,e):this.frameCount%180==0?this.lookAround():this.idle()}draw(t){let e=64*this.currentFrame,i=0;switch(this.movement){case"down":i=0;break;case"up":i=64;break;case"left":i=128;break;case"right":i=192}t.drawImage(this.#r,e,i,64,64,this._position.x-10,this._position.y-10,this._width,this._height)}},_=class extends r{#t;#s;constructor(t,e,i,s){super(t,e),this.#s=i,this.#t=100,this._sprite=s.obstacleSprite}getType(){return this.#s}takeDamage(t){return(this.#t-=t,this.#t<=0)?this.destroy():null}destroy(){console.log("Obstacle destroyed!")}update(){}draw(t){this.#t>0&&t.drawImage(this._sprite,this._position.x,this._position.y,this._width,this._height)}},y=class extends r{#l;constructor(t,e,i,s){super(t,e,i,s),this.#l=!1}selectSprites(t){switch(this._type){case"health":return{crystal:t.redCrystal};case"speed":default:return{crystal:t.blueCrystal};case"strength":return{crystal:t.greenCrystal};case"invincibility":return{crystal:t.yellowCrystal}}}collect(){this.#l||(this.#l=!0,console.log(`Powerup collected: ${this._type}`))}draw(t){this.#l||t.drawImage(this._sprites.crystal,this._position.x,this._position.y,this._width,this._height)}},f=class extends r{constructor(t,e,i){super(t,e,"exit",i),this._sprite=i.yellowRuin,this._sparkles=this._createSparkles()}_createSparkles(){let t=[];for(let e=0;e<20;e++)t.push({x:this._position.x+Math.random()*this._width,y:this._position.y+Math.random()*this._height,vy:-.5+.5*Math.random()});return t}_updateSparkles(){for(let t of this._sparkles)t.y+=t.vy,t.y<this._position.y&&(t.y=this._position.y+this._height)}draw(t){for(let e of(t.fillStyle="rgba(255, 255, 200, 0.3)",t.fillRect(this._position.x,this._position.y,this._width,this._height),t.drawImage(this._sprite,this._position.x,this._position.y,this._width,this._height),this._updateSparkles(),t.fillStyle="rgba(255, 255, 255, 0.8)",this._sparkles))t.beginPath(),t.arc(e.x,e.y,1,0,2*Math.PI),t.fill()}};const w={colors:{background:"#1a0d00",text:"#d4af37",primary:"#8B4513",secondary:"#2e8b57",accent:"#ff4500"},fonts:{main:'"Luminari", "Papyrus", fantasy',subtitle:'"Arial", sans-serif'},fontSize:{title:"52px",subtitle:"28px",button:"24px"},spacing:{padding:"25px"},button:{minWidth:"265px",padding:"15px 35px",borderRadius:"4px"}};function b(t){t.style.backgroundColor=w.colors.background,t.style.color=w.colors.text,t.style.fontFamily=w.fonts.main,t.style.textAlign="center",t.style.padding=w.spacing.padding}function x(t,e=w.colors.primary){t.style.display="block",t.style.margin="20px auto",t.style.padding=w.button.padding,t.style.fontSize=w.fontSize.button,t.style.cursor="pointer",t.style.backgroundColor=e,t.style.color=w.colors.text,t.style.border="2px solid "+w.colors.text,t.style.borderRadius=w.button.borderRadius,t.style.textTransform="uppercase",t.style.letterSpacing="2px",t.style.boxShadow="0 0 10px rgba(212, 175, 55, 0.5)",t.style.transition="all 0.3s ease",t.style.minWidth=w.button.minWidth,t.addEventListener("mouseover",()=>{t.style.transform="scale(1.1)"}),t.addEventListener("mouseout",()=>{t.style.transform="scale(1)"})}class k{constructor(t,e,i,s){this.container=document.getElementById(t),this.canvas=e,this.context=i,this.player=null,this.board=[],this.entities=[],this.walls=[],this.exit=null,this.lives=3,this.score=0,this.currentLevel=1,this.isGameOver=!1,this.started=!1,this.assets=s,this.explosives=[],this.guards=[],this.obstacles=[],this.powerups=[]}initializeBoard(){let t=h.getLevel(this.currentLevel);if(t){this.walls=[],this.board=t.layout;for(let e=0;e<t.layout.length;e++)for(let i=0;i<t.layout[e].length;i++)"#"===t.layout[e][i]&&this.walls.push(new u(i*a.cellWidth,e*a.cellHeight,"normal",this.assets.levelAssets)),"X"===t.layout[e][i]&&(this.exit=new f(i*a.cellWidth,e*a.cellHeight,this.assets.levelAssets))}}initializePlayer(){let t=h.getLevel(this.currentLevel);if(t){for(let e=0;e<t.layout.length;e++)for(let i=0;i<t.layout[e].length;i++)if("P"===t.layout[e][i]){this.player=new l(i*a.cellWidth,e*a.cellHeight,this.assets.playerAssets),this.setupInput();return}}}setupInput(){let t;let e=(e,i)=>()=>{clearTimeout(t),t=setTimeout(()=>{this.player.action="idle"},i),e()};window.addEventListener("keydown",t=>{switch(t.key){case n.up:e(()=>this.player.moveUp(),1e3)();break;case n.down:e(()=>this.player.moveDown(),1e3)();break;case n.left:e(()=>this.player.moveLeft(),1e3)();break;case n.right:e(()=>this.player.moveRight(),1e3)();break;case n.jump:e(()=>this.player.jump(),1e3)();break;case n.attack:e(()=>this.player.attack(),250)();break;case n.pick:e(()=>this.player.pick(),150)();break;case n.axe:e(()=>this.player.axe(),150)();break;case n.potion:e(()=>this.player.potion(),500)()}})}initializeEntities(){let t=h.getLevel(this.currentLevel);if(t){this.explosives=[],this.guards=[],this.obstacles=[],this.powerups=[];for(let e=0;e<t.layout.length;e++)for(let i=0;i<t.layout[e].length;i++){let s=t.layout[e][i],o={x:i*a.cellWidth,y:e*a.cellHeight};switch(s){case"E":this.explosives.push(new g(o.x,o.y,this.assets));break;case"G":let n=Math.floor(3*Math.random())+1;console.log(`orc${n}`),this.guards.push(new m(o.x,o.y,`orc${n}`,this.assets.guardAssets));break;case"O":this.obstacles.push(new _(o.x,o.y,"normal",this.assets));break;case"C":let r=Math.floor(2*Math.random())+1;this.powerups.push(new y(o.x,o.y,1==r?"health":"mana",this.assets.powerupsAssets))}}}}updateGameState(){this.checkCollisions(),this.player.update(),this.explosives.forEach(t=>t.update()),this.guards.forEach(t=>t.update(this.player.getHitBox(),this.walls)),this.obstacles.forEach(t=>t.update()),this.powerups.forEach(t=>t.update()),this.checkLevelCompletion()}checkCollisions(){let t=this.player.getHitBox();["left","right","up","down"].forEach(e=>{let i=this.player.checkCollision(e);this.walls.some(e=>p({...t,x:i.x+.25*t.width,y:i.y+.25*t.height},e.getHitBox()))&&this.player.collide({getPosition:()=>i})}),this.walls.forEach(e=>{p(t,e.getHitBox())&&(console.log("colliding with wall"),this.player.collide(e))}),this.explosives.forEach((e,i)=>{p(t,e.getPosition())&&(e.isActive()||e.isHidden()||(this.player.collectExplosive(e),this.explosives.splice(i,1)))}),this.guards.forEach((e,i)=>{p(t,e.getPosition())}),this.obstacles.forEach((e,i)=>{p(t,e.getPosition())}),this.powerups.forEach((t,e)=>{if(p(this.player.getPickupRange(),t.getPosition())){let i=t.collect();this.player.applyPowerup(i),this.powerups.splice(e,1)}})}checkLevelCompletion(){this.isLevelComplete()&&(this.currentLevel+=1,this.initializeBoard(),this.initializePlayer(),this.initializeEntities())}isLevelComplete(){return p(this.player.getHitBox(),this.exit.getHitBox())}render(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawGrid(),this.walls.forEach(t=>t.draw(this.context)),this.obstacles.forEach(t=>t.draw(this.context)),this.powerups.forEach(t=>t.draw(this.context)),this.guards.forEach(t=>t.draw(this.context)),this.explosives.forEach(t=>t.draw(this.context)),this.exit&&this.exit.draw(this.context),this.player.draw(this.context)}drawGrid(){let t=this.context.createRadialGradient(this.canvas.width/2,this.canvas.height/2,0,this.canvas.width/2,this.canvas.height/2,Math.max(this.canvas.width,this.canvas.height)/2);t.addColorStop(0,"#3E8948"),t.addColorStop(1,"#1A3B1F"),this.context.fillStyle=t,this.context.fillRect(0,0,this.canvas.width,this.canvas.height),this.context.strokeStyle="rgba(0, 255, 0, 0.1)",this.context.lineWidth=1,this.context.beginPath();for(let t=0;t<=this.canvas.width;t+=a.cellWidth)this.context.moveTo(t,0),this.context.lineTo(t,this.canvas.height);for(let t=0;t<=this.canvas.height;t+=a.cellHeight)this.context.moveTo(0,t),this.context.lineTo(this.canvas.width,t);this.context.stroke()}gameLoop(){this.isGameOver||(this.updateGameState(),this.render(),requestAnimationFrame(this.gameLoop.bind(this)))}start(){this.started=!0,d(this.container),this.container.appendChild(this.canvas),this.initializeBoard(),this.initializePlayer(),this.initializeEntities(),this.gameLoop()}continue(){this.started=!0,d(this.container),this.container.appendChild(this.canvas)}}function S(t,e){return new Promise((i,s)=>{try{console.log("Loading image:",t);let o=new Image;o.src=t,o.onload=()=>{console.log("Image loaded:",t),e(t,o),i(o)},o.onerror=e=>{console.error("Error loading image:",t,e),s(Error(`Failed to load image: ${t}`))}}catch(e){console.error("Error loading image:",t,e),s(Error(`Unexpected error loading image: ${t}`))}})}async function H(t){return console.log("Loading player assets..."),{playerMovement:await S(s("12jfn"),t),playerActions:await S(s("6dKHh"),t)}}async function v(t){console.log("Loading guard assets...");let e=await S(s("5dwZ7"),t),i=await S(s("2mQDJ"),t),o=await S(s("5BzKt"),t),a=await S(s("gl7lL"),t),n=await S(s("1SJUz"),t),r=await S(s("jtYkY"),t),l=await S(s("5wsiR"),t),c=await S(s("kHKgT"),t),h=await S(s("1ofSC"),t),d=await S(s("l82DG"),t),p=await S(s("aqAs5"),t),u=await S(s("geGul"),t),g=await S(s("kpWxC"),t),m=await S(s("6L4gS"),t),_=await S(s("l2YvV"),t),y=await S(s("lqbBE"),t),f=await S(s("8e4iu"),t),w=await S(s("f1cee"),t),b=await S(s("1WwBw"),t),x=await S(s("8FuLj"),t),k=await S(s("c4xtF"),t);return{orc1_Attack:e,orc1_Death:i,orc1_Hurt:o,orc1_Idle:a,orc1_Run:n,orc1_Run_Attack:r,orc1_Walk:l,orc1_Walk_Attack:c,orc2_Attack:h,orc2_Death:d,orc2_Hurt:p,orc2_Idle:u,orc2_Run:g,orc2_Run_Attack:m,orc2_Walk:_,orc2_Walk_Attack:y,orc3_Attack:f,orc3_Death:w,orc3_Hurt:b,orc3_Idle:x,orc3_Run:k,orc3_Run_Attack:await S(s("gQ05Q"),t),orc3_Walk:await S(s("9mpTG"),t),orc3_Walk_Attack:await S(s("a62Tn"),t)}}async function E(t){console.log("Loading level assets...");let e=await S(s("hcwiQ"),t);return{rock:e,sandRuin:await S(s("gfIFS"),t),snowRuin:await S(s("dcz8z"),t),yellowRuin:await S(s("8WxSr"),t)}}async function R(t){console.log("Loading powerups assets...");let e=await S(s("gOdju"),t);return{greenCrystal:e,redCrystal:await S(s("l0OAv"),t),blueCrystal:await S(s("6Z5FU"),t),yellowCrystal:await S(s("23iPg"),t)}}const A=[{name:"Player1",score:1e3,timestamp:"2023-10-01 10:00"},{name:"Player2",score:900,timestamp:"2023-10-02 11:00"},{name:"Player3",score:800,timestamp:"2023-10-03 12:00"},{name:"Player4",score:700,timestamp:"2023-10-04 13:00"},{name:"Player5",score:600,timestamp:"2023-10-05 14:00"},{name:"Player6",score:500,timestamp:"2023-10-06 15:00"},{name:"Player7",score:400,timestamp:"2023-10-07 16:00"},{name:"Player8",score:300,timestamp:"2023-10-08 17:00"},{name:"Player9",score:200,timestamp:"2023-10-09 18:00"},{name:"Player10",score:100,timestamp:"2023-10-10 19:00"}];new class{constructor(t){this.container=document.getElementById(t),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=a.width,this.canvas.height=a.height,this.canvas.style.display="block",this.canvas.style.margin="auto",this.container.appendChild(this.canvas),this.currentScreen="splash"}getCanvas(){return this.canvas}getContext(){return this.context}async initialize(){try{console.log("Initializing game...");let t=0,e=(e,i)=>{console.log("Progress:",e,i),t++;let s=Math.floor(t/26*100);!function(t){console.log("Updating splash screen progress:",t);let e=document.getElementById("splash-screen");e&&(e.innerText=`Loading... ${t}%`)}(s)},i=await H(e),s=await E(e),o=await v(e),a=await R(e);this.assets={playerAssets:i,levelAssets:s,guardAssets:o,powerupsAssets:a},this.game=new k(this.container.id,this.canvas,this.context,this.assets),this.showScreen("welcome"),this.setupGameControls()}catch(t){console.error("Error initializing game:",t)}}setupGameControls(){window.addEventListener("keydown",t=>{t.key===n.esc&&this.showScreen("welcome")})}async showScreen(t){switch(console.log("Showing screen:",t),t){case"splash":!function(t,e){let i=document.createElement("div");i.id="splash-screen",i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.width="100%",i.style.height="100%",i.style.backgroundColor="#000",i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center",i.style.color="#fff",i.style.fontSize="24px",i.innerText="Loading... 0%",document.body.appendChild(i),t().then(()=>{e(),document.body.removeChild(i)})}(this.initialize.bind(this),()=>this.showScreen("welcome"));break;case"welcome":!function(t,e,i,s,o){let a=document.getElementById("game-container");a.innerHTML="";let n=document.createElement("div");n.id="welcome-screen";let r=document.createElement("h1");r.textContent="Welcome to Wandertrap!",r.style.textShadow="2px 2px 4px rgba(0, 0, 0, 0.5)",r.style.background="linear-gradient(45deg, #FFD700, #FFA500)",r.style.WebkitBackgroundClip="text",r.style.WebkitTextFillColor="transparent",r.style.display="inline-block",n.appendChild(r);let l=document.createElement("h2");if(l.textContent="Theo got lost...",l.style.color=w.colors.primary,l.style.fontSize=w.fontSize.subtitle,l.style.fontFamily=w.fonts.subtitle,l.style.marginBottom="30px",n.appendChild(l),e){let t=document.createElement("button");t.textContent="Continue",t.onclick=e,n.appendChild(t),x(t,w.colors.secondary)}let c=document.createElement("button");c.textContent="New Game",c.onclick=t,n.appendChild(c);let h=document.createElement("button");h.textContent="Story",h.onclick=o,n.appendChild(h),x(h,w.colors.primary);let d=document.createElement("button");d.textContent="High Scores",d.onclick=i,n.appendChild(d);let p=document.createElement("button");p.textContent="Exit",p.onclick=s,n.appendChild(p),a.appendChild(n),b(a),r.style.fontSize=w.fontSize.title,r.style.marginBottom="20px",x(c),x(d),x(p)}(()=>this.startGame(),this.game&&this.game.started?()=>this.continueGame():null,()=>this.highScore(),()=>this.gameOver(),()=>this.story());break;case"story":!function(t){let e=document.getElementById("game-container");e.innerHTML="";let i=document.createElement("div");i.id="story-screen";let s=document.createElement("div");s.id="text-container",s.style.textAlign="center",i.appendChild(s);let o=["Meet Theo—a brilliant but clumsy game designer with a passion for crafting the most intricate fantasy campaigns.","One fateful evening, while putting the finishing touches on his masterpiece labyrinth, Theo accidentally spills a can of energy drink onto his keyboard.",'Sparks fly, screens flash, and before he can say "critical hit," he\'s zapped into the very world he created!',"Blinking in disbelief, Theo finds himself standing at the entrance of his own labyrinth, a sprawling maze filled with mind-bending puzzles, hidden traps, and mythical creatures.","But he's not alone in there.","His former friend-turned-rival, Max, a fellow gamer notorious for stealing ideas, has hacked into Theo's game to claim the labyrinth as his own.","The power surge pulled Max into the game too, but with a devious advantage—he now controls the Minotaur, the maze's most formidable guardian.",'Max taunts Theo through ethereal echoes: "Good luck finding your way out, Theo! This maze is mine now, and the Minotaur is eager to meet you!"',"Determined to reclaim his creation and return to the real world, Theo must navigate through multiple levels of his labyrinth, solving his own riddles and overcoming challenges he designed to be unbeatable.","Along the way, he'll encounter quirky NPCs, unexpected allies, and maybe even a friendly dragon with a knack for sarcasm.","Can Theo outsmart Max, defeat the Minotaur, and escape the labyrinth?","The twists and turns of his own imagination stand between him and freedom.","Grab your wits, summon your courage, and step into the maze—an epic adventure awaits!"];o.forEach((t,e)=>{let i=document.createElement("p");i.innerHTML=t,i.style.opacity=0,i.style.display="none",i.style.transition="opacity 1s",i.style.fontSize="28px",s.appendChild(i)});let a=document.createElement("div");a.style.textAlign="center",a.style.marginTop="20px";let n=document.createElement("button");n.textContent="Next",n.onclick=function(){l<o.length&&(l>0&&(s.children[l-1].style.opacity=0,s.children[l-1].style.display="none"),s.children[l].style.display="block",s.children[l].style.opacity=1,l++)},a.appendChild(n);let r=document.createElement("button");r.textContent="Skip",r.onclick=t,a.appendChild(r),i.appendChild(a),e.appendChild(i),b(e),i.style.position="relative",i.style.height="100vh",s.style.margin="50px auto",s.style.height="200px",s.style.width="70%",s.style.backgroundColor=w.colors.primary,s.style.color=w.colors.text,s.style.padding="20px",s.style.boxShadow="0 0 10px rgba(0, 0, 0, 0.5)",s.style.borderRadius="10px",x(n,w.colors.primary),x(r,w.colors.primary);let l=0;!function t(){l<o.length&&(l>0&&(s.children[l-1].style.opacity=0,s.children[l-1].style.display="none"),s.children[l].style.display="block",s.children[l].style.opacity=1,l++,setTimeout(t,5e3))}()}(()=>this.showScreen("welcome"));break;case"game":console.log("Starting game...",this.game.canvas),this.game.started?this.game.continue():this.game.start();break;case"gameOver":this.game.started=!1,this.game.gameOver=!0,function(t,e,i){let s=document.getElementById("game-container");s.innerHTML="";let o=document.createElement("div");o.id="game-over-screen";let a=document.createElement("h1");a.textContent="Game Over",o.appendChild(a);let n=document.createElement("p");n.textContent="Oops! Looks like you hit a wall. Better luck next time!",o.appendChild(n);let r=document.createElement("p");r.textContent=`Your Score: ${t}`,o.appendChild(r);let l=document.createElement("button");l.textContent="Try Again",l.onclick=e,o.appendChild(l);let c=document.createElement("button");c.textContent="Main Menu",c.onclick=i,o.appendChild(c),s.appendChild(o),b(s),a.style.fontSize=w.fontSize.title,a.style.marginBottom="20px",n.style.fontSize=w.fontSize.subtitle,n.style.marginBottom="20px",r.style.fontSize=w.fontSize.subtitle,r.style.marginBottom="20px",x(l,w.colors.primary),x(c,w.colors.secondary)}(this.game.score,()=>this.startGame(),()=>this.showScreen("welcome"));break;case"highScore":!function(t){let e=document.getElementById("game-container");e.innerHTML="";let i=document.createElement("div");i.id="high-score-screen";let s=document.createElement("h1");s.textContent="High Scores",i.appendChild(s);let o=document.createElement("table"),a=document.createElement("tr");["Name","Score","Timestamp"].forEach(t=>{let e=document.createElement("th");e.textContent=t,a.appendChild(e)}),o.appendChild(a),A.forEach(t=>{let e=document.createElement("tr");Object.values(t).forEach((t,i)=>{let s=document.createElement("td");2===i?s.textContent=function(t){let e=Math.floor((new Date-new Date(t))/1e3);for(let t of[{label:"year",seconds:31536e3},{label:"month",seconds:2592e3},{label:"week",seconds:604800},{label:"day",seconds:86400},{label:"hour",seconds:3600},{label:"minute",seconds:60},{label:"second",seconds:1}]){let i=Math.floor(e/t.seconds);if(i>=1)return`${i} ${t.label}${1!==i?"s":""} ago`}return"just now"}(t):s.textContent=t,e.appendChild(s)}),o.appendChild(e)}),i.appendChild(o);let n=document.createElement("button");n.textContent="Back",n.onclick=t,i.appendChild(n),e.appendChild(i),b(e),s.style.fontSize=w.fontSize.title,s.style.marginBottom="20px",s.style.color=w.colors.primary,o.style.margin="20px auto",o.style.borderRadius="10px",o.style.borderCollapse="collapse",o.style.width="80%",o.style.backgroundColor=w.colors.background,o.style.color=w.colors.text,o.querySelectorAll("tr").forEach((t,e)=>{0===e&&(t.style.borderTopLeftRadius="10px",t.style.borderTopRightRadius="10px")}),o.querySelectorAll("th").forEach(t=>{t.style.border=`1px solid ${w.colors.primary}`,t.style.padding="12px",t.style.backgroundColor=w.colors.secondary,t.style.color=w.colors.text,t.style.fontSize=w.fontSize.subtitle}),o.querySelectorAll("td").forEach(t=>{t.style.border=`1px solid ${w.colors.secondary}`,t.style.padding="10px",t.style.fontSize=w.fontSize.button}),o.querySelectorAll("tr:not(:first-child)").forEach((t,e)=>{t.style.backgroundColor=e%2==0?w.colors.background:w.colors.secondary+"33"}),x(n,w.colors.primary)}(()=>this.showScreen("welcome"));break;case"levelCompleted":!function(t,e,i){let s=document.getElementById("game-container");s.innerHTML="";let o=document.createElement("div");o.id="level-completed-screen";let a=document.createElement("h1");a.textContent="Level Completed!",o.appendChild(a);let n=document.createElement("p");n.textContent=`Current Score: ${t}`,o.appendChild(n);let r=document.createElement("button");r.textContent="Next Level",r.onclick=e,o.appendChild(r);let l=document.createElement("button");l.textContent="Main Menu",l.onclick=i,o.appendChild(l),s.appendChild(o),b(s),a.style.fontSize=w.fontSize.title,a.style.marginBottom="20px",n.style.fontSize=w.fontSize.subtitle,n.style.marginBottom="20px",x(r,w.colors.accent),x(l,w.colors.secondary)}(this.game.score,()=>this.startGame(),()=>this.showScreen("welcome"));break;default:console.error("Unknown screen:",t)}}story(){this.currentScreen="story",this.showScreen(this.currentScreen)}startGame(){this.currentScreen="game",this.showScreen(this.currentScreen)}continueGame(){this.currentScreen="game",this.showScreen(this.currentScreen)}gameOver(){this.currentScreen="gameOver",this.showScreen(this.currentScreen)}highScore(){this.currentScreen="highScore",this.showScreen(this.currentScreen)}}("game-container").showScreen("splash");
//# sourceMappingURL=index.993b7a7a.js.map
